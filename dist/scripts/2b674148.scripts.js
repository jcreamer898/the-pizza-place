"use strict";function OrderController(a,b,c,d,e){a.itemId=b.id,a.order=e.order,a.totalItems=e.calculateTotalItems(),a.isItem=function(b){return b.id===+a.itemId},a.addItem=function(){e.addToOrder({name:a.item.name,qty:1,options:[],id:a.item.id}),a.calculateTotal()},a.calculateTotal=function(){a.totalItems=e.calculateTotalItems(),a.$bus.publish({channel:"orders",topic:"order.new"})},a.removeItem=function(b){e.removeFromOrder(b),a.calculateTotal()},d.get({itemId:a.itemId}).$promise.then(function(b){a.item=b}).catch(function(a){404===a.status&&c.path("/menu")})}angular.module("introToAngularApp",["ngAnimate","ngCookies","ngResource","ngSanitize","ngRoute"]),function(){var a=[{href:"/",text:"Home",title:"Home",active:!0,templateUrl:"views/main.html",controller:"MainCtrl",order:0},{href:"/menu",text:"Menu",title:"Our Menu",templateUrl:"views/menu.html",controller:"MenuCtrl",controllerAs:"menu",order:1},{href:"/menu/:id",title:"Order",templateUrl:"views/order.html",controller:"OrderCtrl"},{href:"/contact",text:"Contact",title:"Contact Us",templateUrl:"views/contact.html",order:2}];angular.module("introToAngularApp").config(["$routeProvider",function(b){a.forEach(function(a){var c={title:a.title,templateUrl:a.templateUrl,controller:a.controller};a.controllerAs&&(c.controllerAs=a.controllerAs),b.when(a.href,c)}),b.otherwise({redirectTo:"/"})}]).run(["$rootScope",function(a){a.page={title:""},a.$on("$routeChangeSuccess",function(b,c){a.page.title=c.title})}]).value("routes",a)}(),angular.module("introToAngularApp").factory("Menu",["$resource",function(a){return a("api/menu/:itemId",{},{query:{method:"GET",params:{itemId:""},isArray:!0}})}]),angular.module("introToAngularApp").controller("MainCtrl",["$scope",function(a){a.title="Home"}]),angular.module("introToAngularApp").controller("MenuCtrl",["$scope","Menu",function(a,b){this.items=b.query()}]),angular.module("introToAngularApp").controller("NavCtrl",["$scope","$rootScope","$location","routes",function(a,b,c,d){var e;a.items=d,e=function(){var b=a.items.map(function(a){return a.active=!1,a}).filter(function(a){return c.path()===a.href||"/"!==a.href&&c.path().indexOf(a.href)>-1?a:void 0})[0];b.active=!0},a.isNav=function(a){return!!a.text},b.$on("$locationChangeSuccess",e),e()}]),angular.module("introToAngularApp").directive("tppNavigation",function(){return{restrict:"E",templateUrl:"/templates/directives/navigation.html",replace:!0,controller:"NavCtrl",link:function(a,b){console.log(b)}}}),angular.module("introToAngularApp").directive("tppMenuItem",function(){return{templateUrl:"/templates/directives/menuItem.html",restrict:"E",replace:!0,scope:{item:"="}}}),angular.module("introToAngularApp").controller("OrderCtrl",OrderController),angular.module("introToAngularApp").service("Bus",function(){return postal}),angular.module("introToAngularApp").config(["$provide",function(a){a.decorator("$rootScope",["$delegate",function(a){return Object.defineProperty(a.constructor.prototype,"$bus",{get:function(){var a=this;return{subscribe:function(){var b=postal.subscribe.apply(postal,arguments);a.$on("$destroy",function(){b.unsubscribe()})},channel:postal.channel,publish:postal.publish}},enumerable:!1}),a}])}]),angular.module("introToAngularApp").controller("CartCtrl",["$scope","Order",function(a,b){a.totalItems=b.calculateTotalItems(),a.cartItems=b.order,a.$bus.subscribe({channel:"orders",topic:"order.new",callback:function(){a.totalItems=b.calculateTotalItems()}})}]),angular.module("introToAngularApp").directive("multiselect",function(){return{template:'<select ng-model="selected" ng-options="item.id as item.name for item in items" class="multiselect" multiple="multiple"></select>',restrict:"E",replace:!0,scope:{items:"=",selected:"="},link:function(a,b){a.$watch("items",function(){a.items&&b.multiselect()},!0)}}}),angular.module("introToAngularApp").factory("Order",function(){return{order:[],byItem:function(a){return this.order.filter(function(b){return b.id===a})},addToOrder:function(a){this.order.push(a)},removeFromOrder:function(a){this.order.splice(this.order.indexOf(a),1)},calculateTotalItems:function(){return this.order.reduce(function(a,b){return a+parseInt(b.qty,10)},0)||0}}});