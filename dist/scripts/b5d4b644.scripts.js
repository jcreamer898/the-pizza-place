"use strict";function OrderController(a,b,c,d,e){a.itemId=b.id,a.order=e.order,a.totalItems=e.calculateTotalItems(),a.isItem=function(b){return b.id===+a.itemId},a.addItem=function(){e.addToOrder({name:a.item.name,qty:1,options:[],id:a.item.id}),a.calculateTotal()},a.calculateTotal=function(){a.totalItems=e.calculateTotalItems(),a.$bus.publish({channel:"orders",topic:"order.new"})},a.removeItem=function(b){e.removeFromOrder(b),a.calculateTotal()},d.get({itemId:a.itemId}).$promise.then(function(b){a.item=b}).catch(function(a){404===a.status&&c.path("/menu")})}angular.module("introToAngularApp",["ngAnimate","ngCookies","ngResource","ngSanitize","ngRoute"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/menu",{templateUrl:"views/menu.html"}).when("/menu/:id",{templateUrl:"views/order.html",controller:"OrderCtrl"}).otherwise({redirectTo:"/"})}]),angular.module("introToAngularApp").factory("Menu",["$resource",function(a){return a("api/menu/:itemId",{},{query:{method:"GET",params:{itemId:""},isArray:!0}})}]),angular.module("introToAngularApp").controller("MainCtrl",["$scope",function(a){a.title="Home"}]),angular.module("introToAngularApp").controller("AppCtrl",["$scope",function(a){a.page={title:""}}]),angular.module("introToAngularApp").controller("MenuCtrl",["Menu",function(a){this.items=a.query()}]),angular.module("introToAngularApp").controller("NavCtrl",["$scope","$rootScope","$location","routes",function(a,b,c,d){var e;a.items=d,e=function(){var b=a.items.map(function(a){return a.active=!1,a}).filter(function(a){return c.path()===a.href||c.path().split("/")[1].indexOf(a.href)>-1?a:void 0})[0];b.active=!0,a.page.title=b.title},b.$on("$locationChangeSuccess",e),e()}]),angular.module("introToAngularApp").directive("tppNavigation",function(){return{restrict:"E",templateUrl:"/templates/directives/navigation.html",scope:!0}}),angular.module("introToAngularApp").directive("tppMenuItem",function(){return{templateUrl:"/templates/directives/menuItem.html",restrict:"E",replace:!0,scope:{item:"="}}}),angular.module("introToAngularApp").controller("OrderCtrl",OrderController),angular.module("introToAngularApp").directive("price",function(){return{template:"<small></small>",restrict:"E",scope:{price:"@price"},link:function(a,b){a.$watch("price",function(){var c=parseFloat(a.price).toFixed(2);b.text(["$",c].join(""))})}}}),angular.module("introToAngularApp").service("Bus",function(){return postal}),angular.module("introToAngularApp").config(["$provide",function(a){a.decorator("$rootScope",["$delegate",function(a){return Object.defineProperty(a.constructor.prototype,"$bus",{value:postal,enumerable:!1}),a}])}]),angular.module("introToAngularApp").controller("CartCtrl",["$scope","Order",function(a,b){a.totalItems=b.calculateTotalItems(),a.cartItems=b.order,a.$bus.subscribe({channel:"orders",topic:"order.new",callback:function(){a.totalItems=b.calculateTotalItems()}})}]),angular.module("introToAngularApp").directive("multiselect",function(){return{template:'<select ng-model="selected" ng-options="item.id as item.name for item in items" class="multiselect" multiple="multiple"></select>',restrict:"E",replace:!0,scope:{items:"=",selected:"="},link:function(a,b){a.$watch("items",function(){a.items&&b.multiselect()},!0)}}}),angular.module("introToAngularApp").factory("Order",function(){return{order:[],byItem:function(a){return this.order.filter(function(b){return b.id===a})},addToOrder:function(a){this.order.push(a)},removeFromOrder:function(a){this.order.splice(this.order.indexOf(a),1)},calculateTotalItems:function(){return this.order.reduce(function(a,b){return a+parseInt(b.qty,10)},0)||0}}}),angular.module("introToAngularApp").value("routes",[{href:"/",text:"Home",title:"Home",active:!0,order:0},{href:"menu",text:"Menu",title:"Our Menu",order:1},{href:"contact",text:"Contact",title:"Contact Us",order:2}]);